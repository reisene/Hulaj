{"version":3,"file":"post-loader.js","sources":["modules/post-loader.js"],"sourcesContent":["/**\r\n * Loads blog posts from HTML files and enables sorting and searching.\r\n *\r\n * @param {string[]} postPaths - An array of paths to the blog post HTML files.\r\n * @param {jQuery} postsContainer - The container element for the posts.\r\n *\r\n * @returns {Promise} A promise that resolves with an array of post elements.\r\n */\r\nfunction loadPosts(postPaths, postsContainer) {\r\n    const postElements = Array(postPaths.length).fill(null);\r\n    let loadedPosts = 0;\r\n  \r\n    postPaths.forEach((postPath, index) => {\r\n      fetch(postPath)\r\n        .then(response => {\r\n          if (!response.ok) {\r\n            throw new Error(`Failed to load post: ${postPath}`);\r\n          }\r\n\r\n          return response.text();\r\n        })\r\n        .then(data => {\r\n          // Parse HTML data, extract post details, and create a post element.\r\n          const parser = new DOMParser();\r\n          const doc = parser.parseFromString(data, 'text/html');\r\n  \r\n          // Extract post details from the HTML\r\n          const title = $(doc).find('h2').prop('outerHTML') || '<h2>Brak tytułu</h2>';\r\n          const date = $(doc).find('.post-date').prop('outerHTML') || '<p class=\"post-date\"><strong>Data publikacji:</strong> Nieznana</p>';\r\n          const image = $(doc).find('img').prop('outerHTML') || '<p>Brak obrazka</p>';\r\n          const excerpt = $(doc).find('section p').first().prop('outerHTML') || '<p>Brak treści</p>';\r\n  \r\n          // Create a post element\r\n          const postElement = $('<article class=\"post-article\">').html(`${title}${date}${image}<div class=\"post-content\">${excerpt}</div><button class=\"read-more\">Czytaj więcej <i class=\"bi bi-file-earmark-post\"></i></button>`);\r\n  \r\n          // Handle the \"Read More\" button click event\r\n          postElement.find('.read-more').on('click', function (e) {\r\n            // Listens for and handles a click event on the \".read-more\" element, performing\r\n            // several actions when triggered.\r\n            e.preventDefault();\r\n            postsContainer.html($(doc.body).html());\r\n            postsContainer.append('<button class=\"back-to-blog\">Powrót do bloga <i class=\"bi bi-arrow-counterclockwise\"></i></button>');\r\n            $('.back-to-blog').on('click', function () {\r\n              // Triggers on click events and reloads the current page.\r\n              location.reload();\r\n            });\r\n          });\r\n  \r\n          // Store the post element in the appropriate position in the array\r\n          postElements[index] = postElement;\r\n        })\r\n        .catch(error => {\r\n          // Catches and handles an error.\r\n          console.error('Error loading post:', error);\r\n          const errorElement = $('<article class=\"post-article\">').html(`<h2>Błąd</h2><p>Nie udało się załadować posta: ${postPath}</p>`);\r\n          postElements[index] = errorElement; // Zachowujemy błąd w odpowiednim miejscu w tablicy\r\n        })\r\n        .finally(() => {\r\n          // Increments and checks loadedPosts counter, then appends elements when loading is\r\n          // complete.\r\n          loadedPosts++;\r\n          if (loadedPosts === postPaths.length) {\r\n            // Append the post elements in reverse order to the container\r\n            postElements.reverse().forEach(element => postsContainer.append(element));\r\n          }\r\n        });\r\n    });\r\n  \r\n    return Promise.resolve(postElements);\r\n  }\r\n  \r\n  export default loadPosts;"],"names":["loadPosts","postPaths","postsContainer","postElements","Array","length","fill","loadedPosts","forEach","postPath","index","fetch","then","response","ok","text","Error","data","doc","DOMParser","parseFromString","title","$","find","prop","date","image","excerpt","first","postElement","html","on","e","preventDefault","body","append","location","reload","catch","error","console","errorElement","finally","reverse","element","Promise","resolve"],"mappings":"AAQA,SAASA,UAAUC,EAAWC,GAC1B,IAAMC,EAAeC,MAAMH,EAAUI,MAAM,EAAEC,KAAK,IAAI,EAClDC,EAAc,EA0DlB,OAxDAN,EAAUO,QAAQ,CAACC,EAAUC,KAC3BC,MAAMF,CAAQ,EACXG,KAAKC,IACJ,GAAKA,EAASC,GAId,OAAOD,EAASE,KAAK,EAHnB,MAAM,IAAIC,MAAM,wBAAwBP,CAAU,CAItD,CAAC,EACAG,KAAKK,IAGJ,IAAMC,GADS,IAAIC,WACAC,gBAAgBH,EAAM,WAAW,EAGpD,IAAMI,EAAQC,EAAEJ,CAAG,EAAEK,KAAK,IAAI,EAAEC,KAAK,WAAW,GAAK,uBAC/CC,EAAOH,EAAEJ,CAAG,EAAEK,KAAK,YAAY,EAAEC,KAAK,WAAW,GAAK,sEACtDE,EAAQJ,EAAEJ,CAAG,EAAEK,KAAK,KAAK,EAAEC,KAAK,WAAW,GAAK,sBAChDG,EAAUL,EAAEJ,CAAG,EAAEK,KAAK,WAAW,EAAEK,MAAM,EAAEJ,KAAK,WAAW,GAAK,qBAGhEK,EAAcP,EAAE,gCAAgC,EAAEQ,KAAK,GAAGT,EAAQI,EAAOC,+BAAkCC,iGAAuG,EAGxNE,EAAYN,KAAK,YAAY,EAAEQ,GAAG,QAAS,SAAUC,GAGnDA,EAAEC,eAAe,EACjB/B,EAAe4B,KAAKR,EAAEJ,EAAIgB,IAAI,EAAEJ,KAAK,CAAC,EACtC5B,EAAeiC,OAAO,oGAAoG,EAC1Hb,EAAE,eAAe,EAAES,GAAG,QAAS,WAE7BK,SAASC,OAAO,CAClB,CAAC,CACH,CAAC,EAGDlC,EAAaO,GAASmB,CACxB,CAAC,EACAS,MAAMC,IAELC,QAAQD,MAAM,sBAAuBA,CAAK,EACpCE,EAAenB,EAAE,gCAAgC,EAAEQ,uDAAuDrB,OAAc,EAC9HN,EAAaO,GAAS+B,CACxB,CAAC,EACAC,QAAQ,KAGPnC,EAAAA,IACoBN,EAAUI,QAE5BF,EAAawC,QAAQ,EAAEnC,QAAQoC,GAAW1C,EAAeiC,OAAOS,CAAO,CAAC,CAE5E,CAAC,CACL,CAAC,EAEMC,QAAQC,QAAQ3C,CAAY,CACrC,gBAEeH"}